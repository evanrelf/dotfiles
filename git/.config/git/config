# Tip: `git diff -w` ignores whitespace changes

[user]
	name = Evan Relf
	useConfigOnly = true
[alias]
	s = status
	# Truncated log
	l = log --max-count=10 --graph --pretty=format:'%Cred%h%Creset - %s%C(yellow)%d%Creset %Cgreen(%cr)%Creset %Cblue<%an>%Creset'
	# Full log
	lg = log --graph --pretty=format:'%Cred%h%Creset - %s%C(yellow)%d%Creset %Cgreen(%cr)%Creset %Cblue<%an>%Creset'
	# Only show commits ahead of origin/master
	ll = log origin/master.. --graph --pretty=format:'%Cred%h%Creset - %s%C(yellow)%d%Creset %Cgreen(%cr)%Creset %Cblue<%an>%Creset'
	b = branch
	a = "!cd -- ${GIT_PREFIX:-.} && git add \"$@\" && git status && :"
	aa = "!cd -- ${GIT_PREFIX:-.} && git add --all && git status && :"
	r = reset
	f = fetch
	ci = commit
	co = checkout
	d = diff
	ds = diff --staged
	# Only show differences from origin/master
	dd = diff origin/master
	ddn = diff origin/master --name-only
	kd = difftool -y -t Kaleidoscope
	km = mergetool -y -t Kaleidoscope
	st = stash push
	stu = stash push --include-untracked
	stp = stash pop
	stl = stash list
	clean-ignored = clean -Xdf
	clean-untracked = clean -xdi
	# Un-commit
	undo = reset --soft HEAD^
	amend = commit --amend --no-edit
	rename = commit --amend
	# Print the path to the root of the git repo
	root = rev-parse --show-toplevel
	# Run a command from the root of the git repo
	exec = "!exec "
	# Fetch and create a new branch off of origin/master
	new = "!if [ -z \"$1\" ]; then echo 'Usage: git new <BRANCH-NAME> [BASE-BRANCH]'; exit 1; fi && git fetch && if [ -z \"$2\" ]; then git checkout origin/master; else git checkout $2; fi && git checkout -b $1 && :"
	# Fetch and rebase on origin master
	up = "!git fetch && if [ -z \"$1\" ]; then git rebase origin/master; else git rebase origin/$1; fi && :"
	# NOTE: The roles of `theirs` and `ours` are reversed with rebase
	up-favor-local = "!git fetch && if [ -z \"$1\" ]; then git rebase origin/master --strategy-option theirs; else git rebase origin/$1 --strategy-option theirs; fi && :"
	up-favor-remote = "!git fetch && if [ -z \"$1\" ]; then git rebase origin/master --strategy-option ours; else git rebase origin/$1 --strategy-option ours; fi && :"
[core]
	editor = nvim
	pager = diff-so-fancy | less --tabs=2 -RFX
[status]
	showUntrackedFiles = all
[push]
	default = current
	followTags = true
[diff]
	renames = copies
	algorithm = patience
[difftool "Kaleidoscope"]
	cmd = ksdiff --partial-changeset --relative-path \"$MERGED\" -- \"$LOCAL\" \"$REMOTE\"
[mergetool "Kaleidoscope"]
	cmd = ksdiff --merge --output \"$MERGED\" --base \"$BASE\" -- \"$LOCAL\" --snapshot \"$REMOTE\" --snapshot
	trustexitcode = true
[merge]
	conflictstyle = diff3
[color]
	ui = true
[include]
	path = ~/.config/git/local
[color "diff-highlight"]
	oldNormal = red
	oldHighlight = red 52
	newNormal = green
	newHighlight = green 22
[color "diff"]
	meta = yellow
	frag = magenta
	commit = yellow
	old = red
	new = green
	whitespace = red reverse
[fetch]
	prune = true
	pruneTags = true
